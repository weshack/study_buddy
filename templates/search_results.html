<!DOCTYPE html>
<head>
	<link rel="stylesheet" type="text/css" href="css/styles.css">
    <link rel="stylesheet" href="css/foundations/foundation.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>

    <title>Study Buddy-search results</title>
</head>
<body>
    <script>
        function adduser(user,userid){
            $.ajax({
        type: "POST",
        url: "/adduser",
        data: userid,
        success: function (response) {
        $('#container-table tr:last').after('<tr><td>'+'{{user}}'+' </td></tr>');
        $('#adduser').hide();
      },
        error: function(){
            console.log("error");
        }
});
        }

    
    </script>


<div class="fixed">
<nav class="top-bar" data-topbar role="navigation">

      <ul class="title-area">
        <li class="name">
          <h1><a href="/">Study Buddy</a></h1>
        </li>
      </ul>
    
        <section class="top-bar-section">
            <ul class="right">
                <li>
                    <a href="logout">Logout</a>
                </li>
            </ul>
        </section>
    </nav>
    </div>
    <div id="page-header">
        <h2 style="display:inline">Search Results</h2>
        <h5 class="subheader" style="display:inline;margin-left:none">Found 3 results</h5>

        <div id="search-input"> 
            <input style="width:50%; margin:none;display:inline;" type="text" id="studysearch" placeholder="Search for a class..."/>     
        <input style="display:inline-block" type="submit" value="Search" class="small button" id="find">
        </div>
        </div>

        
    <table id="searchresults">	
        <thead>
        <tr>
                <th> Class</th>
                <th> Time</th>
                <th> Location</th>
                <th> Description</th>
                
            </tr>
        </thead>
        <tbody>

    	{% for class in results %}
            <tr>
    			<td class="click" data-id="{{class["course"]}}">{{class.department}}{{class.course_no}}</a></td>
    			<td class="click" data-id="{{class.department}}{{class.course_no}}">{{class.time}}</td>
    			<td class="click" data-id="{{class.department}}{{class.course_no}}">{{class.location}}</td>
    			<td class="click" data-id="{{class.department}}{{class.course_no}}">{{class.description}}</td>
    			
    		</tr>
            <tr>
                <td colspan="4">
                    <div class="container hidden" data-id="{{class.department}}{{class.course_no}}">
                    <div class="students-table">
                    <table id="container-table">
                        {% if not boolen %}
                        <tr>
                            <td><button id="adduser" class="small button" onclick="adduser('{{user}}','{{userid}}')">Join Session</button></td>
                        </tr>
                        {% endif %}
                        {% for user in class.attendees %}
                        <tr>
                        <td>{{user[0]}}</td>
                        </tr>
                        {% endfor %}
                    </table>
                    </div>
                    <div class="notes">
                        <h5>Session Notes</h5>
                        {% if userid==class%}
                        <p>Contact: {{class.contact}} <br> {{class.course_notes}} </p>
                    </div>
                    </div>
                </td>       
            </tr>
            
    	{% endfor %}
        </tbody>
    </table>
    
</body>
</html>